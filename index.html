<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>FairCAPTCHA</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

  <style>
    body{padding-top: 50px;scroll-behavior: smooth;}
    header{
      background:rgb(90,198,169);
      background: radial-gradient(circle at 80% 50%, rgba(60, 72, 88, 0.05) 0%, rgba(60, 72, 88, 0.05) 33.333%, rgba(206, 212, 218, 0.1) 33.333%, rgba(206, 212, 218, 0.1) 66.666%, rgba(73, 80, 87, 0.1) 66.666%, rgba(73, 80, 87, 0.1) 99.999%), linear-gradient(45deg, #00c9a7, #2d84fb)
    }
    .nav-link.active{
      background-color: #f8f9fa!important;
      border-color: #dee2e6 #dee2e6 #f8f9fa!important;
    }
    .tab-content{
      background:#f8f9fa;
      padding:10px;
      min-height:8em;
      border: 1px solid transparent;
      border-color: transparent #dee2e6 #dee2e6;
      border-bottom-left-radius: .25rem;
      border-bottom-right-radius: .25rem;
    }
    p{text-align:justify}
  </style>

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#footer"><img height="40" src="https://naruto.voi.ci/images/logo-light.png"/></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
            <a class="nav-link" href="#desc">Description</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#howto">How-to</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#demo">Demo</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="mailto:faircaptcha@sense.africa">Contact</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="py-5 mb-5">
    <div class="container h-100">
      <div class="row h-100 align-items-center">
        <div class="col-lg-12">
          <h1 class="display-4 text-white mt-5 mb-2">FairCAPTCHA</h1>
          <p class="lead mb-5 text-white-50">Stop bots and help make the web more inclusive.</p>
        </div>
      </div>
    </div>
  </header>

  <!-- Page Content -->
  <div class="container">

    <div class="row">
      <div class="col-md-8 mb-5">
        <h2 id="desc">What is FairCAPTCHA</h2>
        <ul class="nav nav-tabs" role="tablist">
          <li class="nav-item" role="presentation">
            <a class="nav-link active" href="#description" data-toggle="tab" role="tab" aria-controls="description" aria-selected="true" id="description-tab">Description</a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link" href="#justification" data-toggle="tab" role="tab" aria-controls="justification" aria-selected="false" id="justification-tab">Why it matters</a>
          </li>
        </ul>
        <div class="tab-content" id="tab_what_is">
          <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
            <p>FairCAPTCHA is an AI-powered open-source captcha solution to stop spam and bots on websites and apps.</p>
            <p>This solution gives website owners more control and is more respectful of users' privacy. Also, it  contributes to making technology more inclusive, by transparently learning from data sourced from diverse and usually under-represented people.</p>
            <p>Current  status is <span class="badge badge-warning">OPEN BETA</span></p>
          </div>
          <div class="tab-pane fade" id="justification" role="tabpanel" aria-labelledby="justification-tab">
            This is why it matters
          </div>
        </div>
        <br/>
        <h2 id="how-to">Get FairCAPTCHA</h2>
        <ol class="nav nav-tabs" role="tablist">
          <li class="nav-item" role="presentation">
            <a class="nav-link active" href="#step1" data-toggle="tab" role="tab" aria-controls="step1" aria-selected="true" id="step1-tab">1: Options</a>
          </li>
          <li class="nav-item"  role="presentation">
            <a class="nav-link disabled" href="#step2" aria-disabled="true" data-toggle="tab" role="tab" aria-controls="step2" id="step2-tab">2: API keys</a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link disabled" href="#step3" aria-disabled="true" data-toggle="tab" role="tab" aria-controls="step3" id="step3-tab">3: Front-end</a>
          </li>
          <li class="nav-item" role="presentation">
            <a class="nav-link disabled" href="#step4" aria-disabled="true" data-toggle="tab" role="tab" aria-controls="step4" id="step4-tab">4: Back-end</a>
          </li>
        </ol>
        <div class="tab-content" id="tab_get">
          <div class="tab-pane fade show active" id="step1" role="tabpanel" aria-labelledby="step1-tab">
            <form onsubmit="return process_form(this);">
              <div class="form-group">
                <label for="exampleFormControlInput1">Email address</label>
                <input type="email" class="form-control" name="email" placeholder="name@example.com" aria-describedby="email_explain" required>
                <small id="email_explain" class="form-text text-muted">
                  A unique code will be sent to this address to manage the API key.
                </small>
              </div>
              <div class="form-group">
                <label for="exampleFormControlInput2">url of your site</label>
                <input type="url" class="form-control" name="url" placeholder="https://sense_afria.cm" aria-describedby="url_explain" required>
                <small id="url_explain" class="form-text text-muted">
                  for identified user
                </small>
              </div>
              <div class="form-group">
                <label for="exampleFormControlSelect1">API endpoint</label>
                <select class="form-control" name="endpoint" aria-describedby="endpoints_needed">
                  <option value="http://127.0.0.1:8080">Localhost</option>
                  <option value="https://salty-ocean-83073.herokuapp.com">Sense Africa (beta)</option>
                </select>
                <small id="endpoints_needed" class="form-text text-muted">
                  Do you run a trustworthy endpoint? <a href="mailto:faircaptcha@sense.africa">Contact us</a> to be featured here.
                </small>
              </div>
              <div class="form-group">
                <label for="exampleFormControlSelect2">Signals used for bot detection</label>
                <select multiple class="form-control" name="signals" aria-describedby="signals_explain" required>
                  <option selected value="request">IP address and other request metadata</option>
                  <option selected value="device">Device characteristics</option>
                  <option selected value="behavior">Scrolling and behavior on webpage</option>
                  <option selected value="cookie">Actions on other webpages (uses cookie)</option>
                  <option selected value="auto">All future signals (notified by  e-mail)</option>
                </select>
                <small id="signals_explain" class="form-text text-muted">
                  More signals result in better accuracy. Options can be changed later.
                </small>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="terms" name="terms" required>
                <label class="form-check-label" for="terms">
                  I agree to the <a>Terms and Privacy</a> notices of the API  endpoint. 
                </label>
              </div>
              <br/>
              <div class="col-md-12 bg-light text-right">
                <button type="submit" class="btn btn-primary mb-2">Save options</button>
              </div>
            </form>
          </div>
          <div class="tab-pane fade" id="step2" role="tabpanel" aria-labelledby="step2-tab">
            <button type="button" class="btn btn-secondary mb-2" onclick="gen_keys()">Generate unique keys</button>
            <div class="spinner-border spinner-border-sm ml-2" role="status" id="keys_loading" style="display:none;">
              <span class="sr-only">Loading...</span>
            </div>
            <br/>
            <div class="form-group">
              <textarea class="form-control" id="key_display" readonly rows="5" aria-describedby="copy_keys" style="font-family: monospace;"></textarea>
              <small id="copy_keys" class="form-text text-muted">
                <a href="javascript:copy_keys()">copy to clipboard</a>
              </small>
            </div>
            <br/>
            <div class="col-md-12 bg-light text-right">
              <a   id="keys_saved" class="btn btn-primary mb-2 disabled" role="button" aria-disabled="true">I have saved my keys</a>
            </div>
          </div>
          <div class="tab-pane fade" id="step3" role="tabpanel" aria-labelledby="step3-tab">
            <div class="form-group">
              <textarea class="form-control"  readonly rows="2" style="font-family: monospace;">
<input id="token" class="d-none" type="text">
              </textarea>
              <p>
                This input must be added to your form so that you can retrieve the token that we will</br>
                have generated for a given user 
              </p>
              <textarea class="form-control" id="frontend_display" readonly rows="5" aria-describedby="copy_frontend" style="font-family: monospace;">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
$(document).ready(function () {
    $.ajax('https://faircaptcha.herokuapp.com/captcha/getStart/?client_key=your_client_key',{
    type: "GET",
    success: function(response) {
      $("#faircaptcha").append(response);    
    }}); 
});
</script>  
              </textarea>
              <small id="copy_frontend" class="form-text text-muted">
                <a href="javascript:copy_frontend()">copy to clipboard</a>
              </small>
              <p>
                You must receive a div block with the <strong>faircaptcha</strong> identifier, in which the captcha will be placed.
                You must also add these scripts in your code finally to contact the server to have the captcha 
              </p>
            </div>
            <br/>
            <div class="col-md-12 bg-light text-right">
              <a   id="frontend_saved" class="btn btn-primary mb-2" role="button">I have copied source code</a>
            </div>
          </div>
          <div class="tab-pane fade" id="step4" role="tabpanel" aria-labelledby="step4-tab">
            <div class="form-group">
              <p>
                You need to make a request from your backend to check the score of a given user.
                You must provide:</br>
                    - Your client_key</br>
                    - Tour secret_key</br>
                    - The user's token</br>
              </p>
              <p><strong>Example : </strong></p>
              <textarea class="form-control" id="backend_display" readonly rows="5" aria-describedby="copy_backend" style="font-family: monospace;">
                $.ajax('https://faircaptcha.herokuapp.com/captcha/getScore/', {
                  type: 'POST',
                  data: { 
                      token : $("#token").val(),
                      secret_key : your secret_key,
                      client_key : your client_key,
                  },
                  success: (data, status, xhr) => {
                      console.log(data)
                  },
                  error: function (jqXhr, textStatus, errorMessage) {
                      console.log("error")
              }});
              </textarea>
              <small id="copy_backend" class="form-text text-muted">
                <a href="javascript:copy_backend()">copy to clipboard</a>
              </small>
            </div>
          </div>
        </div>
        
        <!-- <a class="btn btn-primary btn-lg"  href="#">Call to Action &raquo;</a>  -->
      </div>
      <div class="col-md-4 mb-5">
        <div class="row" style="justify-content: space-around;">
            <h2 id="demo">Demo </h2>
            <a class="btn btn-primary btn-lg" id="Relaunch">Relaunch</a>
        </div>
        <hr>
        <div class="d-flex justify-content-center">
          <input id="token" class="d-none" type="text">
          <div id="faircaptcha" style="padding: 10%;">
        </div>
      </div>
    </div>
    <!-- /.row -->

  </div>
  <!-- /.container -->

  <!-- Footer -->
  <footer id="footer"class="py-5 bg-light">
    <div class="container text-right">
      <p class="m-0 text-center" style="font-family:monospace">Copyright &copy; Sense Africa 2020</p>
      <img height="60" src="https://naruto.voi.ci/images/logo-dark.png"href="https://sense.africa"/>
    </div>
    <!-- /.container -->
  </footer>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script>
  <script type="text/javascript">
    $(document).ready(function () {
    $.ajax('https://faircaptcha.herokuapp.com/captcha/getStart/?client_key=m3ME5XfIMEKaPZ3',{
        type: "GET",
        success: function(response) {
        $("#faircaptcha").append(response);    
    }}); 
    }); 
    
    $('#Relaunch').click(
    (event)=>
    {
        event.preventDefault();
        $.ajax('https://faircaptcha.herokuapp.com/captcha/getStart/?client_key=m3ME5XfIMEKaPZ3',{
        type: "GET",
        success: function(response) {
        $("#faircaptcha").replaceWith(response);    
    }});
    })
  </script>
  <script type="text/javascript">
    var key_display = document.getElementById("key_display");
    var generating_keys = false;

    function process_form(form)
    {
      if (form.terms.checked)
      {
        let options={
          email:form.email.value,
          url:form.url.value,
          endpoint:form.endpoint.value,
          signals:[]
        };
        let i=0;
        for(i=0;i<form.signals.options.length;i++){
          if (form.signals.options[i].selected){
            options.signals.push(form.signals.options[i].value)
          }
        }
        console.log(options.signalsÃ©)
        if (localStorage.getItem("options") != JSON.stringify(options)){
          localStorage.setItem("options", JSON.stringify(options));
          key_display.value="";
        }
        activate_step(2);
      }
      return false;
    }
    function activate_step(step){
      console.log(step)
      $("#step"+step+"-tab").removeClass("disabled")
      $("#step"+step+"-tab").click();
      $("#step"+step+"-tab").trigger("click");
    }
    function display_key(text, color){
      key_display.style.color = color || "black";
      key_display.value = text;
    }
    function gen_keys(){
      if(localStorage.getItem("options")) {
        options = JSON.parse(localStorage.getItem("options"));
        if (generating_keys || typeof(options.processed)!="undefined") return;

        key_display.value="";
        generating_keys=true;
        $("#keys_loading").show();
        $.post(
          "https://faircaptcha.herokuapp.com/captcha/site/",
          options,
          function(data){
            var submitted_options = options;
            try{
              console.log(data)
              let resp = JSON.parse(data);
              if (typeof(resp)=="object"
                && typeof(resp.api_key)=="string"
                && typeof(resp.secret)=="string"){
                //new account ok
                submitted_options.processed = true;
                localStorage.setItem("options", JSON.stringify(submitted_options))
                display_key(JSON.stringify(resp,null,2));
                $("#keys_saved").removeClass("disabled");
              } else throw "Incorrect server response"
            }
            catch(err){
              //account creation failed
              display_key(err + "\nTry again later or switch endpoint", "red")
            }   
          },
          "text")
          .fail(function(){
            display_key("Network error\nTry again later or switch endpoint", "red")
          })
          .always(function(){
            $("#keys_loading").hide();
            generating_keys=false;
          })

      }
    }

    function copy_keys(){
      var message;

      if (key_display.value){
        key_display.select();
        key_display.setSelectionRange(0, 99999); /*For mobile devices*/

        document.execCommand("copy");
        message = "key text copied"
        
      } else message = "no text to copy";

      $('#copy_keys a').tooltip({
          title:message,
          placement:"bottom",
          trigger:"manual"
        }).tooltip('show');
        setTimeout(function(){
          $('#copy_keys a').tooltip('hide')
        }, 2000);
    }
    
    function copy_frontend(){
      var message;

      if (frontend_display.value){
        frontend_display.select();
        frontend_display.setSelectionRange(0, 99999); /*For mobile devices*/

        document.execCommand("copy");
        message = "source code  copied"
        
      } else message = "no text to copy";

      $('#copy_frontend a').tooltip({
          title:message,
          placement:"bottom",
          trigger:"manual"
        }).tooltip('show');
        setTimeout(function(){
          $('#copy_frontend a').tooltip('hide')
        }, 2000);
    }

    function copy_backend(){
      var message;
      if (backend_display.value){
        backend_display.select();
        backend_display.setSelectionRange(0, 99999); /*For mobile devices*/
        document.execCommand("copy");
        message = "backend text copied"
      } else message = "no text to copy";
      $('#copy_backend a').tooltip({
          title:message,
          placement:"bottom",
          trigger:"manual"
        }).tooltip('show');
        setTimeout(function(){
          $('#copy_backend a').tooltip('hide')
        }, 2000);
    }

    $('#keys_saved').click(
    (event)=>
    {
        event.preventDefault();
        activate_step(3);
    })

    $('#frontend_saved').click(
    (event)=>
    {
        event.preventDefault();
        activate_step(4);
    })
  </script>

  <!-- Bootstrap core JavaScript -->
  <!-- <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script> -->

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

</body>

</html>
